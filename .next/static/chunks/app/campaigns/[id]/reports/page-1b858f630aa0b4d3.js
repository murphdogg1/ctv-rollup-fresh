(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[429],{3141:function(e,t,n){Promise.resolve().then(n.bind(n,2495))},9205:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(2265);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>!!e&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,r.forwardRef)((e,t)=>{let{color:n="currentColor",size:s=24,strokeWidth:c=2,absoluteStrokeWidth:o,className:i="",children:d,iconNode:u,...x}=e;return(0,r.createElement)("svg",{ref:t,...l,width:s,height:s,stroke:n,strokeWidth:o?24*Number(c)/Number(s):c,className:a("lucide",i),...x},[...u.map(e=>{let[t,n]=e;return(0,r.createElement)(t,n)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let n=(0,r.forwardRef)((n,l)=>{let{className:o,...i}=n;return(0,r.createElement)(c,{ref:l,iconNode:t,className:a("lucide-".concat(s(e)),o),...i})});return n.displayName="".concat(e),n}},6215:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},2208:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},525:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},2495:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return w}});var r=n(7437),s=n(2265),a=n(5475),l=n(2381),c=n(9820),o=n(7168),i=n(3448);function d(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,r.jsx)("table",{"data-slot":"table",className:(0,i.cn)("w-full caption-bottom text-sm",t),...n})})}function u(e){let{className:t,...n}=e;return(0,r.jsx)("thead",{"data-slot":"table-header",className:(0,i.cn)("[&_tr]:border-b",t),...n})}function x(e){let{className:t,...n}=e;return(0,r.jsx)("tbody",{"data-slot":"table-body",className:(0,i.cn)("[&_tr:last-child]:border-0",t),...n})}function h(e){let{className:t,...n}=e;return(0,r.jsx)("tr",{"data-slot":"table-row",className:(0,i.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...n})}function m(e){let{className:t,...n}=e;return(0,r.jsx)("th",{"data-slot":"table-head",className:(0,i.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...n})}function p(e){let{className:t,...n}=e;return(0,r.jsx)("td",{"data-slot":"table-cell",className:(0,i.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...n})}var f=n(9205);let g=(0,f.Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),j=(0,f.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var v=n(6215),b=n(525),y=n(2208),N=n(4438);function w(){let e=(0,a.useParams)().id,[t,n]=(0,s.useState)(null),[i,f]=(0,s.useState)([]),[w,k]=(0,s.useState)([]),[C,_]=(0,s.useState)([]),[Z,S]=(0,s.useState)(!0),[R,A]=(0,s.useState)("app");(0,s.useEffect)(()=>{e&&L()},[e]);let L=async()=>{try{S(!0),console.log("Fetching data for campaign:",e);let[t,r,s]=await Promise.all([fetch("/api/campaigns/".concat(e,"/rollup/app")),fetch("/api/campaigns/".concat(e,"/rollup/genre")),fetch("/api/campaigns/".concat(e,"/rollup/content"))]),a=await t.json(),l=await r.json(),c=await s.json();console.log("App rollup data:",a),console.log("Genre rollup data:",l),console.log("Content rollup data:",c),a.success&&(f(a.rollup),n(a.campaign)),l.success&&k(l.rollup),c.success&&_(c.rollup)}catch(e){console.error("Failed to fetch campaign data:",e),N.Am.error("Failed to fetch campaign data")}finally{S(!1)}},z=async n=>{try{console.log("Exporting:",n);let r=await fetch("/api/campaigns/".concat(e,"/export?type=").concat(n));if(!r.ok)throw Error("Export failed: ".concat(r.status));let s=await r.blob(),a=window.URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download="".concat((null==t?void 0:t.name)||"campaign","-").concat(n,"-rollup.csv"),document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(a),N.Am.success("".concat(n," export successful!"))}catch(e){console.error("Export error:",e),N.Am.error("Failed to export ".concat(n," data"))}},E=i.reduce((e,t)=>e+t.impressions,0),O=i.reduce((e,t)=>e+t.completes,0);return Z?(0,r.jsxs)("div",{className:"container mx-auto py-8 text-center",children:[(0,r.jsx)(g,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-lg text-gray-600",children:"Loading campaign reports..."}),(0,r.jsx)(l.z,{onClick:L,className:"mt-4",children:"Retry"})]}):t?(0,r.jsxs)("div",{className:"container mx-auto py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold",children:[t.name," Reports"]}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Detailed performance metrics for your campaign"})]}),(0,r.jsxs)(l.z,{onClick:()=>z(R),children:[(0,r.jsx)(j,{className:"w-4 h-4 mr-2"}),"Export CSV"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(c.ll,{className:"text-sm font-medium",children:"Total Impressions"}),(0,r.jsx)(v.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsx)(c.aY,{children:(0,r.jsx)("div",{className:"text-2xl font-bold",children:E.toLocaleString()})})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(c.ll,{className:"text-sm font-medium",children:"Total Completes"}),(0,r.jsx)(b.Z,{className:"h-4 h-4 text-muted-foreground"})]}),(0,r.jsx)(c.aY,{children:(0,r.jsx)("div",{className:"text-2xl font-bold",children:O.toLocaleString()})})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(c.ll,{className:"text-sm font-medium",children:"Overall VCR"}),(0,r.jsx)(y.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsx)(c.aY,{children:(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[E>0?Math.round(O/E*1e4)/100:0,"%"]})})]})]}),(0,r.jsxs)(o.mQ,{value:R,onValueChange:A,className:"w-full",children:[(0,r.jsxs)(o.dr,{className:"grid w-full grid-cols-3",children:[(0,r.jsx)(o.SP,{value:"app",children:"App Rollup"}),(0,r.jsx)(o.SP,{value:"genre",children:"Genre Rollup"}),(0,r.jsx)(o.SP,{value:"content",children:"Content Rollup"})]}),(0,r.jsx)(o.nU,{value:"app",children:(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{children:[(0,r.jsx)(c.ll,{children:"App Rollup"}),(0,r.jsx)(c.SZ,{children:"Performance by Content Network Name (App)"})]}),(0,r.jsx)(c.aY,{children:i.length>0?(0,r.jsx)("div",{className:"rounded-md border",children:(0,r.jsxs)(d,{children:[(0,r.jsx)(u,{children:(0,r.jsxs)(h,{children:[(0,r.jsx)(m,{children:"App Name"}),(0,r.jsx)(m,{children:"Impressions"}),(0,r.jsx)(m,{children:"Completes"}),(0,r.jsx)(m,{children:"Avg VCR (%)"}),(0,r.jsx)(m,{children:"Content Count"})]})}),(0,r.jsx)(x,{children:i.map((e,t)=>(0,r.jsxs)(h,{children:[(0,r.jsx)(p,{className:"font-medium",children:e.app_name}),(0,r.jsx)(p,{children:e.impressions.toLocaleString()}),(0,r.jsx)(p,{children:e.completes.toLocaleString()}),(0,r.jsxs)(p,{children:[e.avg_vcr,"%"]}),(0,r.jsx)(p,{children:e.content_count})]},t))})]})}):(0,r.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No app rollup data available"})})]})}),(0,r.jsx)(o.nU,{value:"genre",children:(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{children:[(0,r.jsx)(c.ll,{children:"Genre Rollup"}),(0,r.jsx)(c.SZ,{children:"Performance by Genre"})]}),(0,r.jsx)(c.aY,{children:w.length>0?(0,r.jsx)("div",{className:"rounded-md border",children:(0,r.jsxs)(d,{children:[(0,r.jsx)(u,{children:(0,r.jsxs)(h,{children:[(0,r.jsx)(m,{children:"Genre"}),(0,r.jsx)(m,{children:"Impressions"}),(0,r.jsx)(m,{children:"Completes"}),(0,r.jsx)(m,{children:"Avg VCR (%)"}),(0,r.jsx)(m,{children:"Content Count"})]})}),(0,r.jsx)(x,{children:w.map((e,t)=>(0,r.jsxs)(h,{children:[(0,r.jsxs)(p,{className:"font-medium",children:[e.avg_vcr,"%"]}),(0,r.jsx)(p,{children:e.impressions.toLocaleString()}),(0,r.jsx)(p,{children:e.completes.toLocaleString()}),(0,r.jsxs)(p,{children:[e.avg_vcr,"%"]}),(0,r.jsx)(p,{children:e.content_count})]},t))})]})}):(0,r.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No genre rollup data available"})})]})}),(0,r.jsx)(o.nU,{value:"content",children:(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{children:[(0,r.jsx)(c.ll,{children:"Content Rollup"}),(0,r.jsx)(c.SZ,{children:"Performance by Content Title"})]}),(0,r.jsx)(c.aY,{children:C.length>0?(0,r.jsx)("div",{className:"rounded-md border",children:(0,r.jsxs)(d,{children:[(0,r.jsx)(u,{children:(0,r.jsxs)(h,{children:[(0,r.jsx)(m,{children:"Content Title"}),(0,r.jsx)(m,{children:"App Name"}),(0,r.jsx)(m,{children:"Impressions"}),(0,r.jsx)(m,{children:"Completes"}),(0,r.jsx)(m,{children:"Avg VCR (%)"})]})}),(0,r.jsx)(x,{children:C.map((e,t)=>(0,r.jsxs)(h,{children:[(0,r.jsx)(p,{className:"font-medium",children:e.content_title}),(0,r.jsx)(p,{children:e.content_network_name}),(0,r.jsx)(p,{children:e.impressions.toLocaleString()}),(0,r.jsx)(p,{children:e.completes.toLocaleString()}),(0,r.jsxs)(p,{children:[e.avg_vcr,"%"]})]},t))})]})}):(0,r.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No content rollup data available"})})]})})]})]}):(0,r.jsxs)("div",{className:"container mx-auto py-8 text-center",children:[(0,r.jsx)("p",{className:"text-lg text-red-600",children:"Campaign not found"}),(0,r.jsx)(l.z,{onClick:L,className:"mt-4",children:"Retry"})]})}},2381:function(e,t,n){"use strict";n.d(t,{z:function(){return o}});var r=n(7437);n(2265);var s=n(7495),a=n(535),l=n(3448);let c=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:t,variant:n,size:a,asChild:o=!1,...i}=e,d=o?s.g7:"button";return(0,r.jsx)(d,{"data-slot":"button",className:(0,l.cn)(c({variant:n,size:a,className:t})),...i})}},9820:function(e,t,n){"use strict";n.d(t,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return a},aY:function(){return i},ll:function(){return c}});var r=n(7437);n(2265);var s=n(3448);function a(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...n})}function l(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...n})}function c(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",t),...n})}function o(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",t),...n})}function i(e){let{className:t,...n}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",t),...n})}},7168:function(e,t,n){"use strict";n.d(t,{SP:function(){return o},dr:function(){return c},mQ:function(){return l},nU:function(){return i}});var r=n(7437);n(2265);var s=n(3105),a=n(3448);function l(e){let{className:t,...n}=e;return(0,r.jsx)(s.fC,{"data-slot":"tabs",className:(0,a.cn)("flex flex-col gap-2",t),...n})}function c(e){let{className:t,...n}=e;return(0,r.jsx)(s.aV,{"data-slot":"tabs-list",className:(0,a.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...n})}function o(e){let{className:t,...n}=e;return(0,r.jsx)(s.xz,{"data-slot":"tabs-trigger",className:(0,a.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n})}function i(e){let{className:t,...n}=e;return(0,r.jsx)(s.VY,{"data-slot":"tabs-content",className:(0,a.cn)("flex-1 outline-none",t),...n})}},3448:function(e,t,n){"use strict";n.d(t,{cn:function(){return a}});var r=n(1994),s=n(3335);function a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.m6)((0,r.W)(t))}}},function(e){e.O(0,[569,438,105,971,117,744],function(){return e(e.s=3141)}),_N_E=e.O()}]);