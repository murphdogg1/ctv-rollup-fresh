(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{3023:function(e,r,t){Promise.resolve().then(t.bind(t,6657))},6657:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return c}});var a=t(7437),n=t(2265),s=t(9820),i=t(2381),o=t(3944),l=t(9174),d=t(4438);function c(){let[e,r]=(0,n.useState)(!1),[t,c]=(0,n.useState)(0),[u,f]=(0,n.useState)(null),[m,v]=(0,n.useState)(!1),p=(0,n.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?v(!0):"dragleave"===e.type&&v(!1)},[]),x=(0,n.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),v(!1);let r=Array.from(e.dataTransfer.files);r.length>0&&g(r)},[]),g=async e=>{r(!0),c(0),f(null);try{let r=new FormData;e.forEach(e=>{r.append("file",e);let t=e.name.replace(/\.[^/.]+$/,"").replace(/[_-]/g," ");r.append("campaignName",t)});let t=await fetch("/api/campaigns/ingest",{method:"POST",body:r});if(!t.ok)throw Error("Upload failed: ".concat(t.statusText));let a=await t.json();f(a),a.success?(d.Am.success("Successfully created campaign: ".concat(a.campaign.name)),a.content&&d.Am.success("Processed ".concat(a.content.rowsProcessed," rows"))):d.Am.error("Upload failed: ".concat(a.error))}catch(e){console.error("Upload error:",e),d.Am.error(e instanceof Error?e.message:"Upload failed")}finally{r(!1),c(100)}},h=async()=>{try{(await fetch("/api/rebuild",{method:"POST"})).ok?d.Am.success("Views rebuilt successfully"):d.Am.error("Failed to rebuild views")}catch(e){console.error("Rebuild error:",e),d.Am.error("Failed to rebuild views")}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Upload Data"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Upload CSV or Parquet files containing CTV delivery logs for ingestion and analysis."})]}),(0,a.jsxs)(s.Zb,{children:[(0,a.jsxs)(s.Ol,{children:[(0,a.jsx)(s.ll,{children:"File Upload"}),(0,a.jsx)(s.SZ,{children:"Drag and drop files or click to select. Supports CSV and Parquet formats."})]}),(0,a.jsx)(s.aY,{children:(0,a.jsx)("div",{className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors ".concat(m?"border-blue-500 bg-blue-50":"border-gray-300"),onDragEnter:p,onDragLeave:p,onDragOver:p,onDrop:x,children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"text-gray-400",children:(0,a.jsx)("svg",{className:"mx-auto h-12 w-12",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,a.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-lg font-medium text-gray-900",children:"Drop files here or click to select"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"CSV and Parquet files supported"})]}),(0,a.jsx)("input",{type:"file",multiple:!0,accept:".csv,.parquet",onChange:e=>{let r=Array.from(e.target.files||[]);r.length>0&&g(r)},className:"hidden",id:"file-upload"}),(0,a.jsx)("label",{htmlFor:"file-upload",children:(0,a.jsx)(i.z,{asChild:!0,children:(0,a.jsx)("span",{children:"Select Files"})})})]})})})]}),e&&(0,a.jsxs)(s.Zb,{children:[(0,a.jsx)(s.Ol,{children:(0,a.jsx)(s.ll,{children:"Uploading..."})}),(0,a.jsxs)(s.aY,{children:[(0,a.jsx)(o.E,{value:t,className:"w-full"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Processing files..."})]})]}),u&&(0,a.jsxs)(s.Zb,{children:[(0,a.jsx)(s.Ol,{children:(0,a.jsx)(s.ll,{children:"Upload Results"})}),(0,a.jsxs)(s.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Rows Inserted"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:u.rowsInserted})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Detected Columns"}),(0,a.jsx)("p",{className:"text-2xl font-bold",children:u.detectedColumns.length})]})]}),u.detectedColumns.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500 mb-2",children:"Detected Columns"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:u.detectedColumns.map((e,r)=>(0,a.jsx)(l.C,{variant:"outline",children:e},r))})]}),u.sampleRows.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500 mb-2",children:"Sample Data"}),(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,a.jsx)("pre",{className:"text-xs overflow-x-auto",children:JSON.stringify(u.sampleRows,null,2)})})]}),(0,a.jsx)("div",{className:"flex space-x-2",children:(0,a.jsx)(i.z,{onClick:h,variant:"outline",children:"Rebuild Views"})})]})]})]})}},9174:function(e,r,t){"use strict";t.d(r,{C:function(){return l}});var a=t(7437);t(2265);var n=t(7495),s=t(535),i=t(3448);let o=(0,s.j)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:r,variant:t,asChild:s=!1,...l}=e,d=s?n.g7:"span";return(0,a.jsx)(d,{"data-slot":"badge",className:(0,i.cn)(o({variant:t}),r),...l})}},2381:function(e,r,t){"use strict";t.d(r,{z:function(){return l}});var a=t(7437);t(2265);var n=t(7495),s=t(535),i=t(3448);let o=(0,s.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:r,variant:t,size:s,asChild:l=!1,...d}=e,c=l?n.g7:"button";return(0,a.jsx)(c,{"data-slot":"button",className:(0,i.cn)(o({variant:t,size:s,className:r})),...d})}},9820:function(e,r,t){"use strict";t.d(r,{Ol:function(){return i},SZ:function(){return l},Zb:function(){return s},aY:function(){return d},ll:function(){return o}});var a=t(7437);t(2265);var n=t(3448);function s(e){let{className:r,...t}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",r),...t})}function i(e){let{className:r,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",r),...t})}function o(e){let{className:r,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)("leading-none font-semibold",r),...t})}function l(e){let{className:r,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,n.cn)("text-muted-foreground text-sm",r),...t})}function d(e){let{className:r,...t}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("px-6",r),...t})}},3944:function(e,r,t){"use strict";t.d(r,{E:function(){return y}});var a=t(7437),n=t(2265),s=t(3966),i=t(6840),o="Progress",[l,d]=(0,s.b)(o),[c,u]=l(o),f=n.forwardRef((e,r)=>{var t,n,s,o;let{__scopeProgress:l,value:d=null,max:u,getValueLabel:f=p,...m}=e;(u||0===u)&&!h(u)&&console.error((t="".concat(u),n="Progress","Invalid prop `max` of value `".concat(t,"` supplied to `").concat(n,"`. Only numbers greater than 0 are valid max values. Defaulting to `").concat(100,"`.")));let v=h(u)?u:100;null===d||b(d,v)||console.error((s="".concat(d),o="Progress","Invalid prop `value` of value `".concat(s,"` supplied to `").concat(o,"`. The `value` prop must be:\n  - a positive number\n  - less than the value passed to `max` (or ").concat(100," if no `max` prop is set)\n  - `null` or `undefined` if the progress is indeterminate.\n\nDefaulting to `null`.")));let j=b(d,v)?d:null,y=g(j)?f(j,v):void 0;return(0,a.jsx)(c,{scope:l,value:j,max:v,children:(0,a.jsx)(i.WV.div,{"aria-valuemax":v,"aria-valuemin":0,"aria-valuenow":g(j)?j:void 0,"aria-valuetext":y,role:"progressbar","data-state":x(j,v),"data-value":null!=j?j:void 0,"data-max":v,...m,ref:r})})});f.displayName=o;var m="ProgressIndicator",v=n.forwardRef((e,r)=>{var t;let{__scopeProgress:n,...s}=e,o=u(m,n);return(0,a.jsx)(i.WV.div,{"data-state":x(o.value,o.max),"data-value":null!==(t=o.value)&&void 0!==t?t:void 0,"data-max":o.max,...s,ref:r})});function p(e,r){return"".concat(Math.round(e/r*100),"%")}function x(e,r){return null==e?"indeterminate":e===r?"complete":"loading"}function g(e){return"number"==typeof e}function h(e){return g(e)&&!isNaN(e)&&e>0}function b(e,r){return g(e)&&!isNaN(e)&&e<=r&&e>=0}v.displayName=m;var j=t(3448);function y(e){let{className:r,value:t,...n}=e;return(0,a.jsx)(f,{"data-slot":"progress",className:(0,j.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",r),...n,children:(0,a.jsx)(v,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(t||0),"%)")}})})}},3448:function(e,r,t){"use strict";t.d(r,{cn:function(){return s}});var a=t(1994),n=t(3335);function s(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,n.m6)((0,a.W)(r))}},3966:function(e,r,t){"use strict";t.d(r,{b:function(){return s}});var a=t(2265),n=t(7437);function s(e,r=[]){let t=[],s=()=>{let r=t.map(e=>a.createContext(e));return function(t){let n=t?.[e]||r;return a.useMemo(()=>({[`__scope${e}`]:{...t,[e]:n}}),[t,n])}};return s.scopeName=e,[function(r,s){let i=a.createContext(s),o=t.length;t=[...t,s];let l=r=>{let{scope:t,children:s,...l}=r,d=t?.[e]?.[o]||i,c=a.useMemo(()=>l,Object.values(l));return(0,n.jsx)(d.Provider,{value:c,children:s})};return l.displayName=r+"Provider",[l,function(t,n){let l=n?.[e]?.[o]||i,d=a.useContext(l);if(d)return d;if(void 0!==s)return s;throw Error(`\`${t}\` must be used within \`${r}\``)}]},function(...e){let r=e[0];if(1===e.length)return r;let t=()=>{let t=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let n=t.reduce((r,{useScope:t,scopeName:a})=>{let n=t(e)[`__scope${a}`];return{...r,...n}},{});return a.useMemo(()=>({[`__scope${r.scopeName}`]:n}),[n])}};return t.scopeName=r.scopeName,t}(s,...r)]}},6840:function(e,r,t){"use strict";t.d(r,{WV:function(){return i}});var a=t(2265);t(4887);var n=t(7495),s=t(7437),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let t=(0,n.Z8)(`Primitive.${r}`),i=a.forwardRef((e,a)=>{let{asChild:n,...i}=e,o=n?t:r;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(o,{...i,ref:a})});return i.displayName=`Primitive.${r}`,{...e,[r]:i}},{})}},function(e){e.O(0,[569,438,971,117,744],function(){return e(e.s=3023)}),_N_E=e.O()}]);